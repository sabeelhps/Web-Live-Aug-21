{"version":3,"file":"index.mjs","sources":["../src/on-css-function.ts","../src/index.ts","../src/has-supports-at-rule-ancestor.ts"],"sourcesContent":["import valueParser from 'postcss-value-parser';\nimport type { FunctionNode, Dimension, Node, DivNode, WordNode } from 'postcss-value-parser';\n\nfunction onCSSFunction(node: FunctionNode) {\n\tconst value = node.value;\n\tconst rawNodes = node.nodes;\n\tconst relevantNodes = rawNodes.slice().filter((x) => {\n\t\treturn x.type !== 'comment' && x.type !== 'space';\n\t});\n\n\tlet nodes: Rgb | Hsl | null = null;\n\tif (value === 'hsl' || value === 'hsla') {\n\t\tnodes = hslFunctionContents(relevantNodes);\n\t} else if (value === 'rgb' || value === 'rgba') {\n\t\tnodes = rgbFunctionContents(relevantNodes);\n\t}\n\n\tif (!nodes) {\n\t\treturn;\n\t}\n\n\tif (relevantNodes.length > 3 && (!nodes.slash || !nodes.alpha)) {\n\t\treturn;\n\t}\n\n\ttransformAlpha(node, nodes.slash, nodes.alpha);\n\n\t/** Extracted Color channels. */\n\tconst [channelNode1, channelNode2] = channelNodes(nodes);\n\n\tnode.nodes.splice(node.nodes.indexOf(channelNode1) + 1, 0, commaNode());\n\tnode.nodes.splice(node.nodes.indexOf(channelNode2) + 1, 0, commaNode());\n}\n\nexport default onCSSFunction;\n\nfunction commaNode(): DivNode {\n\treturn {\n\t\tsourceIndex: 0,\n\t\tsourceEndIndex: 1,\n\t\tvalue: ',',\n\t\ttype: 'div',\n\t\tbefore: '',\n\t\tafter: '',\n\t};\n}\n\nfunction isNumericNode(node: Node): node is WordNode {\n\tif (!node || node.type !== 'word') {\n\t\treturn false;\n\t}\n\n\tif (!canParseAsUnit(node)) {\n\t\treturn false;\n\t}\n\n\tconst unitAndValue = valueParser.unit(node.value);\n\tif (!unitAndValue) {\n\t\treturn false;\n\t}\n\n\treturn !!unitAndValue.number;\n}\n\nfunction isNumericNodeHueLike(node: Node): node is WordNode {\n\tif (!node || node.type !== 'word') {\n\t\treturn false;\n\t}\n\n\tif (!canParseAsUnit(node)) {\n\t\treturn false;\n\t}\n\n\tconst unitAndValue = valueParser.unit(node.value);\n\tif (!unitAndValue) {\n\t\treturn false;\n\t}\n\n\treturn !!unitAndValue.number && (\n\t\tunitAndValue.unit === 'deg' ||\n\t\tunitAndValue.unit === 'grad' ||\n\t\tunitAndValue.unit === 'rad' ||\n\t\tunitAndValue.unit === 'turn' ||\n\t\tunitAndValue.unit === ''\n\t);\n}\n\nfunction isNumericNodePercentageOrNumber(node: Node): node is WordNode {\n\tif (!node || node.type !== 'word') {\n\t\treturn false;\n\t}\n\n\tif (!canParseAsUnit(node)) {\n\t\treturn false;\n\t}\n\n\tconst unitAndValue = valueParser.unit(node.value);\n\tif (!unitAndValue) {\n\t\treturn false;\n\t}\n\n\treturn unitAndValue.unit === '%' || unitAndValue.unit === '';\n}\n\nfunction isCalcNode(node: Node): node is FunctionNode {\n\treturn node && node.type === 'function' && node.value === 'calc';\n}\n\nfunction isVarNode(node: Node): node is FunctionNode {\n\treturn node && node.type === 'function' && node.value === 'var';\n}\n\nfunction isSlashNode(node: Node): node is DivNode {\n\treturn node && node.type === 'div' && node.value === '/';\n}\n\ntype Hsl = {\n\th: Dimension,\n\thNode: Node,\n\ts: Dimension,\n\tsNode: Node,\n\tl: Dimension,\n\tlNode: Node,\n\tslash?: DivNode,\n\talpha?: WordNode|FunctionNode,\n}\n\nfunction hslFunctionContents(nodes): Hsl|null {\n\tif (!isNumericNodeHueLike(nodes[0])) {\n\t\treturn null;\n\t}\n\n\tif (!isNumericNodePercentageOrNumber(nodes[1])) {\n\t\treturn null;\n\t}\n\n\tif (!isNumericNodePercentageOrNumber(nodes[2])) {\n\t\treturn null;\n\t}\n\n\tconst out: Hsl = {\n\t\th: valueParser.unit(nodes[0].value) as Dimension,\n\t\thNode: nodes[0],\n\t\ts: valueParser.unit(nodes[1].value) as Dimension,\n\t\tsNode: nodes[1],\n\t\tl: valueParser.unit(nodes[2].value) as Dimension,\n\t\tlNode: nodes[2],\n\t};\n\n\tnormalizeHueNode(out.h);\n\tif (out.h.unit !== '') {\n\t\treturn null;\n\t}\n\n\tout.hNode.value = out.h.number;\n\n\tif (isSlashNode(nodes[3])) {\n\t\tout.slash = nodes[3];\n\t}\n\n\tif ((isNumericNodePercentageOrNumber(nodes[4]) || isCalcNode(nodes[4]) || isVarNode(nodes[4]))) {\n\t\tout.alpha = nodes[4];\n\t}\n\n\treturn out;\n}\n\ntype Rgb = {\n\tr: Dimension,\n\trNode: Node,\n\tg: Dimension,\n\tgNode: Node,\n\tb: Dimension,\n\tbNode: Node,\n\tslash?: DivNode,\n\talpha?: WordNode | FunctionNode,\n}\n\nfunction rgbFunctionContents(nodes): Rgb|null {\n\tif (!isNumericNodePercentageOrNumber(nodes[0])) {\n\t\treturn null;\n\t}\n\n\tif (!isNumericNodePercentageOrNumber(nodes[1])) {\n\t\treturn null;\n\t}\n\n\tif (!isNumericNodePercentageOrNumber(nodes[2])) {\n\t\treturn null;\n\t}\n\n\tconst out: Rgb = {\n\t\tr: valueParser.unit(nodes[0].value) as Dimension,\n\t\trNode: nodes[0],\n\t\tg: valueParser.unit(nodes[1].value) as Dimension,\n\t\tgNode: nodes[1],\n\t\tb: valueParser.unit(nodes[2].value) as Dimension,\n\t\tbNode: nodes[2],\n\t};\n\n\tif (out.r.unit === '%') {\n\t\tout.r.number = String(Math.floor(Number(out.r.number) / 100 * 255));\n\t\tout.rNode.value = out.r.number;\n\t}\n\n\tif (out.g.unit === '%') {\n\t\tout.g.number = String(Math.floor(Number(out.g.number) / 100 * 255));\n\t\tout.gNode.value = out.g.number;\n\t}\n\n\tif (out.b.unit === '%') {\n\t\tout.b.number = String(Math.floor(Number(out.b.number) / 100 * 255));\n\t\tout.bNode.value = out.b.number;\n\t}\n\n\tif (isSlashNode(nodes[3])) {\n\t\tout.slash = nodes[3];\n\t}\n\n\tif ((isNumericNodePercentageOrNumber(nodes[4]) || isCalcNode(nodes[4]) || isVarNode(nodes[4]))) {\n\t\tout.alpha = nodes[4];\n\t}\n\n\treturn out;\n}\n\nfunction isRgb(x: Hsl | Rgb): x is Rgb {\n\tif (typeof (x as Rgb).r !== 'undefined') {\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n\nfunction channelNodes(x: Hsl | Rgb): [Node, Node, Node] {\n\tif (isRgb(x)) {\n\t\treturn [x.rNode, x.gNode, x.bNode];\n\t}\n\n\treturn [x.hNode, x.sNode, x.lNode];\n}\n\nfunction transformAlpha(node: FunctionNode, slashNode: DivNode | undefined, alphaNode: WordNode | FunctionNode | undefined) {\n\tif (node.value === 'hsl' || node.value === 'hsla') {\n\t\tnode.value = 'hsl';\n\t} else if (node.value === 'rgb' || node.value === 'rgba') {\n\t\tnode.value = 'rgb';\n\t}\n\n\tif (!slashNode || !alphaNode) {\n\t\treturn;\n\t}\n\n\tif (node.value === 'hsl') {\n\t\tnode.value = 'hsla';\n\t} else {\n\t\tnode.value = 'rgba';\n\t}\n\n\tslashNode.value = ',';\n\tslashNode.before = '';\n\n\tif (!isNumericNode(alphaNode)) {\n\t\treturn;\n\t}\n\n\tconst unitAndValue = valueParser.unit(alphaNode.value);\n\tif (!unitAndValue) {\n\t\treturn;\n\t}\n\n\tif (unitAndValue.unit === '%') {\n\t\t// transform the Alpha channel from a Percentage to (0-1) Number\n\t\tunitAndValue.number = String(parseFloat(unitAndValue.number) / 100);\n\t\talphaNode.value = String(unitAndValue.number);\n\t}\n}\n\nfunction normalizeHueNode(dimension: Dimension) {\n\tswitch (dimension.unit) {\n\t\tcase 'deg':\n\t\t\tdimension.unit = '';\n\t\t\treturn;\n\t\tcase 'rad':\n\t\t\t// radians -> degrees\n\t\t\tdimension.unit = '';\n\t\t\tdimension.number = Math.round(parseFloat(dimension.number) * 180 / Math.PI).toString();\n\t\t\treturn;\n\n\t\tcase 'grad':\n\t\t\t// grades -> degrees\n\t\t\tdimension.unit = '';\n\t\t\tdimension.number = Math.round(parseFloat(dimension.number) * 0.9).toString();\n\t\t\treturn;\n\n\t\tcase 'turn':\n\t\t\t// turns -> degrees\n\t\t\tdimension.unit = '';\n\t\t\tdimension.number = Math.round(parseFloat(dimension.number) * 360).toString();\n\t\t\treturn;\n\t}\n}\n\nfunction canParseAsUnit(node : Node): boolean {\n\tif (!node || !node.value) {\n\t\treturn false;\n\t}\n\n\ttry {\n\t\treturn valueParser.unit(node.value) !== false;\n\t} catch (e) {\n\t\treturn false;\n\t}\n}\n","import valueParser from 'postcss-value-parser';\nimport type { ParsedValue, FunctionNode } from 'postcss-value-parser';\nimport type { Declaration, Postcss, Result } from 'postcss';\nimport onCSSFunction from './on-css-function';\n\nimport type { PluginCreator } from 'postcss';\nimport { hasSupportsAtRuleAncestor } from './has-supports-at-rule-ancestor';\n\n/** Transform lab() and lch() functions in CSS. */\nconst postcssPlugin: PluginCreator<{ preserve: boolean }> = (opts?: { preserve: boolean }) => {\n\tconst preserve = 'preserve' in Object(opts) ? Boolean(opts.preserve) : false;\n\n\treturn {\n\t\tpostcssPlugin: 'postcss-color-functional-notation',\n\t\tDeclaration: (decl: Declaration, { result, postcss }: { result: Result, postcss: Postcss }) => {\n\t\t\tif (preserve && hasSupportsAtRuleAncestor(decl)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst originalValue = decl.value;\n\t\t\tif (!(/(^|[^\\w-])(hsla?|rgba?)\\(/i.test(originalValue))) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet valueAST: ParsedValue|undefined;\n\n\t\t\ttry {\n\t\t\t\tvalueAST = valueParser(originalValue);\n\t\t\t} catch (error) {\n\t\t\t\tdecl.warn(\n\t\t\t\t\tresult,\n\t\t\t\t\t`Failed to parse value '${originalValue}' as a hsl or rgb function. Leaving the original value intact.`,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (typeof valueAST === 'undefined') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvalueAST.walk((node) => {\n\t\t\t\tif (!node.type || node.type !== 'function') {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\tnode.value !== 'hsl' &&\n\t\t\t\t\tnode.value !== 'hsla' &&\n\t\t\t\t\tnode.value !== 'rgb' &&\n\t\t\t\t\tnode.value !== 'rgba'\n\t\t\t\t) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tonCSSFunction(node as FunctionNode);\n\t\t\t});\n\t\t\tconst modifiedValue = String(valueAST);\n\n\t\t\tif (modifiedValue === originalValue) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (preserve && decl.variable) {\n\t\t\t\tconst parent = decl.parent;\n\t\t\t\tconst atSupportsParams = '(color: rgb(0 0 0 / 0.5)) and (color: hsl(0 0% 0% / 0.5))';\n\t\t\t\tconst atSupports = postcss.atRule({ name: 'supports', params: atSupportsParams, source: decl.source });\n\n\t\t\t\tconst parentClone = parent.clone();\n\t\t\t\tparentClone.removeAll();\n\n\t\t\t\tparentClone.append(decl.clone());\n\t\t\t\tatSupports.append(parentClone);\n\n\t\t\t\t// Ensure correct order of @supports rules\n\t\t\t\t// Find the last one created by us or the current parent and insert after.\n\t\t\t\tlet insertAfter = parent;\n\t\t\t\tlet nextInsertAfter = parent.next();\n\t\t\t\twhile (\n\t\t\t\t\tinsertAfter &&\n\t\t\t\t\tnextInsertAfter &&\n\t\t\t\t\tnextInsertAfter.type === 'atrule' &&\n\t\t\t\t\tnextInsertAfter.name === 'supports' &&\n\t\t\t\t\tnextInsertAfter.params === atSupportsParams\n\t\t\t\t) {\n\t\t\t\t\tinsertAfter = nextInsertAfter;\n\t\t\t\t\tnextInsertAfter = nextInsertAfter.next();\n\t\t\t\t}\n\n\t\t\t\tinsertAfter.after(atSupports);\n\n\t\t\t\tdecl.value = modifiedValue;\n\t\t\t} else if (preserve) {\n\t\t\t\tdecl.cloneBefore({ value: modifiedValue });\n\t\t\t} else {\n\t\t\t\tdecl.value = modifiedValue;\n\t\t\t}\n\t\t},\n\t};\n};\n\npostcssPlugin.postcss = true;\n\nexport default postcssPlugin;\n","import type { Node, AtRule } from 'postcss';\n\nexport function hasSupportsAtRuleAncestor(node: Node): boolean {\n\tlet parent = node.parent;\n\twhile (parent) {\n\t\tif (parent.type !== 'atrule') {\n\t\t\tparent = parent.parent;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif ((parent as AtRule).name === 'supports' && (parent as AtRule).params.indexOf('(color: rgb(0 0 0 / 0.5)) and (color: hsl(0 0% 0% / 0.5))') !== -1) {\n\t\t\treturn true;\n\t\t}\n\n\t\tparent = parent.parent;\n\t}\n\n\treturn false;\n}\n"],"names":["onCSSFunction","node","value","relevantNodes","nodes","slice","filter","x","type","canParseAsUnit","unitAndValue","valueParser","unit","number","isNumericNodeHueLike","isNumericNodePercentageOrNumber","out","h","hNode","s","sNode","l","lNode","dimension","Math","round","parseFloat","PI","toString","normalizeHueNode","isSlashNode","slash","isCalcNode","isVarNode","alpha","hslFunctionContents","r","rNode","g","gNode","b","bNode","String","floor","Number","rgbFunctionContents","length","slashNode","alphaNode","before","isNumericNode","transformAlpha","channelNode1","channelNode2","isRgb","channelNodes","splice","indexOf","sourceIndex","sourceEndIndex","after","e","postcssPlugin","opts","preserve","Object","Boolean","Declaration","decl","result","postcss","parent","name","params","hasSupportsAtRuleAncestor","originalValue","test","valueAST","error","warn","walk","modifiedValue","variable","atSupportsParams","atSupports","atRule","source","parentClone","clone","removeAll","append","insertAfter","nextInsertAfter","next","cloneBefore"],"mappings":"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"}